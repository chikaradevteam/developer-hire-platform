generator client {
  provider = "prisma-client"
}

datasource db {
  provider = "mongodb"
}

enum ROLE {
  INTERVIEWER
  CANDIDATE
}

enum READ {
  SEEN
  UNSEEN
}

enum ROUND {
  DSA
  HR
}

enum JOB_STATUS {
  ONGOING
  COMPLETED
}

enum JOB_TYPE {
  REMOTE
  ONSITE
}

enum APPLICATIONSTATUS {
  APPLIED
  ONGOING
  REJECTED
  SELECTED
}

enum FILE_TYPE {
  DOC
  PDF
  IMG
}

model User {
  id              String  @id @map("_id") @db.ObjectId
  name            String
  email           String  @unique
  password        String
  avatar          String?
  phoneNumber     String  @unique
  username        String  @unique
  role            ROLE    @default(CANDIDATE)
  roleId          String?
  bio             String?
  tagline         String?
  linkedinProfile String?

  skills        Skill[]
  interviewer   Interviewer?
  candidate     Candidate?
  taggedPeoples TaggedPeople[]
}

model Skill {
  id     String @id @map("_id") @db.ObjectId
  name   String
  userId String @db.ObjectId
  user   User   @relation(fields: [userId], references: [id])
}

model Interviewer {
  id           String @id @map("_id") @db.ObjectId
  organization String
  company_role String

  userId String @unique @db.ObjectId
  user   User   @relation(fields: [userId], references: [id])

  messages           InPlatformMessage[]
  interviewWishlists InterviewWishlist[]
  jobPostings        JobPosting[]
  interviewInvites   InterviewInvite[]
  interviews         Interview[]
}

model Candidate {
  id                String @id @map("_id") @db.ObjectId
  githubUserName    String
  leetcodeUserName  String
  codeforceUserName String
  mediumUserName    String
  resume            String

  userId                   String                     @unique @db.ObjectId
  user                     User                       @relation(fields: [userId], references: [id])
  interviewInvites         InterviewInvite[]
  interviews               Interview[]
  experiences              Experience[]
  projectPosts             ProjectPost[]
  interviewWishlistMembers InterviewWishlistMembers[]
  jobApplications          JobApplication[]
}

model InPlatformMessage {
  id         String @id @map("_id") @db.ObjectId
  readRecipt READ   @default(UNSEEN)
  message    String

  sentBy String?      @db.ObjectId
  sender Interviewer? @relation(fields: [sentBy], references: [id])
}

model InterviewWishlist {
  id                       String                     @id @map("_id") @db.ObjectId
  name                     String
  createdBy                String                     @db.ObjectId
  creator                  Interviewer                @relation(fields: [createdBy], references: [id])
  interviewWishlistMembers InterviewWishlistMembers[]
}

model InterviewWishlistMembers {
  id                  String            @id @map("_id") @db.ObjectId
  candidateId         String            @db.ObjectId
  candidate           Candidate         @relation(fields: [candidateId], references: [id])
  projecPostId        String            @db.ObjectId
  projectPost         ProjectPost       @relation(fields: [projecPostId], references: [id])
  interviewWishListId String            @db.ObjectId
  interviewerWishList InterviewWishlist @relation(fields: [interviewWishListId], references: [id])
}

model JobPosting {
  id              String           @id @map("_id") @db.ObjectId
  title           String
  description     String
  createdBy       String           @db.ObjectId
  creator         Interviewer      @relation(fields: [createdBy], references: [id])
  jobApplications JobApplication[]
}

model InterviewInvite {
  id            String      @id @map("_id") @db.ObjectId
  message       String
  interviewerId String      @db.ObjectId
  interviewer   Interviewer @relation(fields: [interviewerId], references: [id])
  sentTo        String      @db.ObjectId
  candidate     Candidate   @relation(fields: [sentTo], references: [id])
}

model Interview {
  id                 String          @id @map("_id") @db.ObjectId
  interviewRound     ROUND           @default(DSA)
  interviewStartDate DateTime
  interviewEndTime   DateTime
  createdBy          String          @db.ObjectId
  interviewer        Interviewer     @relation(fields: [createdBy], references: [id])
  attemptedBy        String          @db.ObjectId
  candidate          Candidate       @relation(fields: [attemptedBy], references: [id])
  interviewChats     InterviewChat[]
}

model Experience {
  id           String     @id @map("_id") @db.ObjectId
  candidateId  String     @db.ObjectId
  candidate    Candidate  @relation(fields: [candidateId], references: [id])
  company      String
  startDate    DateTime
  endDate      DateTime?
  description  String
  contribution String
  status       JOB_STATUS @default(ONGOING)
  jobType      JOB_TYPE   @default(ONSITE)
}

model ProjectPost {
  id                       String                     @id @map("_id") @db.ObjectId
  description              String
  gitUrl                   String
  createdBy                String                     @db.ObjectId
  candidate                Candidate                  @relation(fields: [createdBy], references: [id])
  interviewWishlistMembers InterviewWishlistMembers[]
  taggedPeoples            TaggedPeople[]
  attachments              Attachment[]
}

model JobApplication {
  id           String            @id @map("_id") @db.ObjectId
  candidateId  String            @db.ObjectId
  candidate    Candidate         @relation(fields: [candidateId], references: [id])
  jobId        String            @db.ObjectId
  jobPostingId JobPosting        @relation(fields: [jobId], references: [id])
  extraRemarks String
  status       APPLICATIONSTATUS @default(APPLIED)
}

model InterviewChat {
  id          String    @id @map("_id") @db.ObjectId
  message     String
  sentBy      String    @db.ObjectId
  interviewId String    @db.ObjectId
  interview   Interview @relation(fields: [interviewId], references: [id])
}

model TaggedPeople {
  id           String      @id @map("_id") @db.ObjectId
  userId       String      @db.ObjectId
  user         User        @relation(fields: [userId], references: [id])
  belongToPost String      @db.ObjectId
  post         ProjectPost @relation(fields: [belongToPost], references: [id])
}

model Attachment {
  id           String      @id @map("_id") @db.ObjectId
  name         String
  url          String
  type         FILE_TYPE   @default(IMG)
  belongToPost String      @db.ObjectId
  post         ProjectPost @relation(fields: [belongToPost], references: [id])
}
